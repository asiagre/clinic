CREATE TABLE DOCTORS_AUD (
	EVENT_ID INT(11) NOT NULL AUTO_INCREMENT,
    EVENT_DATE DATETIME NOT NULL,
    EVENT_TYPE VARCHAR(10) DEFAULT NULL,
    DOCTOR_ID INT(11) NOT NULL,
    OLD_FIRSTNAME VARCHAR(255),
    NEW_FIRSTNAME VARCHAR(255),
    OLD_LASTNAME VARCHAR(255),
    NEW_LASTNAME VARCHAR(255),
    OLD_SPECIALIZATION VARCHAR(255),
    NEW_SPECIALIZATION VARCHAR(255),
    OLD_RATING DECIMAL(5,2),
    NEW_RATING VARCHAR(5,2),
    PRIMARY KEY (`EVENT_ID`)
);

DELIMITER $$

CREATE TRIGGER DOCTORS_INSERT AFTER INSERT ON DOCTORS
FOR EACH ROW
BEGIN
    INSERT INTO DOCTORS_AUD (EVENT_DATE, EVENT_TYPE, DOCTOR_ID, NEW_FIRSTNAME,             NEW_LASTNAME, NEW_SPECIALIZATION, NEW_RATING)
        VALUES (CURTIME(), "INSERT", DOCTOR_ID, NEW.FIRSTNAME, NEW.LASTNAME, NEW.SPECIALIZATION, NEW.RATING);
END $$

DELIMITER ;

DELIMITER $$

CREATE TRIGGER DOCTORS_DELETE AFTER DELETE ON DOCTORS
FOR EACH ROW
BEGIN
    INSERT INTO DOCTORS_AUD (EVENT_DATE, EVENT_TYPE, DOCTOR_ID)
        VALUES (CURTIME(), "DELETE", DOCTOR_ID);
END $$

DELIMITER ;

DELIMITER $$

CREATE TRIGGER DOCTORS_UPDATE AFTER UPDATE ON DOCTORS
FOR EACH ROW
BEGIN
    INSERT INTO DOCTORS_AUD (EVENT_DATE, EVENT_TYPE, DOCTOR_ID, NEW_FIRSTNAME, NEW_LASTNAME, NEW_SPECIALIZATION, NEW_RATING, OLD_FIRSTNAME, OLD_LASTNAME, OLD_SPECIALIZATION, OLD_RATING)
        VALUES (CURTIME(), "UPDATE", DOCTOR_ID, NEW.FIRSTNAME, NEW.LASTNAME, NEW.SPECIALIZATION, NEW.RATING, OLD.FIRSTNAME, OLD.LASTNAME, OLD.SPECIALIZATION, OLD.RATING);
END $$

DELIMITER ;
